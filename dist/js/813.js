"use strict";(self["webpackChunkchronicle"]=self["webpackChunkchronicle"]||[]).push([[813,154],{1028:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"polar-picture-tool",class:{mobile:e.is_mobile},on:{mousemove:e.handle_mousemove,mousedown:e.handle_mousedown,mouseup:e.handle_mouseup,contextmenu:function(e){e.preventDefault()},dragenter:function(t){return t.preventDefault(),e.handle_dragenter.apply(null,arguments)},dragover:function(t){return t.preventDefault(),e.handle_dragover.apply(null,arguments)},drop:function(t){return t.preventDefault(),e.handle_drop.apply(null,arguments)}}},[t("ThreeRenderer",{ref:"three_renderer",attrs:{download_image_name:e.download_image_name,show_controls:!e.dragging}},[t("p",{staticClass:"button open-file",on:{click:e.open_file}},[e._v("open file")]),t("div",{staticClass:"separator"}),t("p",{staticClass:"button toggle-grid",class:{active:e.grid},on:{click:function(t){e.grid=!e.grid}}},[e._v("grid")]),t("p",{staticClass:"button toggle-tiling",class:{active:e.tiling>0},domProps:{innerHTML:e._s(e.tiling_label)},on:{click:function(t){return e.set_tiling(e.tiling+1)}}}),t("div",{staticClass:"separator"}),t("p",{staticClass:"button mode",class:{active:0===e.mode},on:{click:function(t){return e.set_mode(0)}}},[e._v("original")]),t("p",{staticClass:"button mode",class:{active:1===e.mode},on:{click:function(t){return e.set_mode(1)}}},[e._v("polar to carthesian")]),t("p",{staticClass:"button mode",class:{active:2===e.mode},on:{click:function(t){return e.set_mode(2)}}},[e._v("polar flip")]),t("p",{staticClass:"button mode",class:{active:3===e.mode},on:{click:function(t){return e.set_mode(3)}}},[e._v("carthesian to polar")]),t("p",{staticClass:"button mode",class:{active:4===e.mode},on:{click:function(t){return e.set_mode(4)}}},[e._v("carthesian to polar [b]")])]),e.is_mobile?e._e():t("div",{staticClass:"drop-target",class:{dragging:e.dragging}},[e.dragging?t("p",[e._v("Drag and drop an image here")]):e._e()]),t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.handle_image_upload}}),e.grid?t("div",{staticClass:"grid"},[t("div"),t("div")]):e._e(),e.dragging?e._e():t("div",{staticClass:"info"},[e.is_mobile?e._e():t("p",[e._v("offset: "+e._s(e.round_to(e.texture_offset.x,4))+", "+e._s(e.round_to(e.texture_offset.y,4)))]),e.is_mobile?e._e():t("p",[e._v("scale: "+e._s(e.round_to(e.texture_scale.x,4))+", "+e._s(e.round_to(e.texture_scale.y,3)))]),e.is_mobile?e._e():t("div",{staticClass:"separator"}),e.is_mobile?e._e():t("p",{staticClass:"instructions"},[e._v(" This applet allows you to transform the content of an image with radial symmetry into a tileable pattern. You can also do the reverse - wrap a seamless pattern around a circle, turning it into an object with radial symmetry. ")]),e.is_mobile?e._e():t("div",{staticClass:"separator"}),e.is_mobile?e._e():t("p",{staticClass:"instructions"},[e._v("Adjust the "),t("span",{staticClass:"offset"},[e._v("offset")]),e._v(" with the "),t("span",{staticClass:"offset"},[e._v("left")]),e._v(" mouse button, "),t("span",{staticClass:"scale"},[e._v("scale")]),e._v(" with the "),t("span",{staticClass:"scale"},[e._v("right")]),e._v(" mouse button, and "),t("span",{staticClass:"reset"},[e._v("reset")]),e._v(" transformations with the "),t("span",{staticClass:"reset"},[e._v("middle")]),e._v(" mouse button or the "),t("span",{staticClass:"reset"},[e._v("space")]),e._v(" key. ")]),e.is_mobile?t("p",{staticClass:"instructions"},[e._v(" The applet does not have full functionality support on mobile devices - it's better to switch to a PC. ")]):e._e()])],1)},a=[],n=s(1114),r=s(7581),o=s(1479),l=s(4026),_=s(3889),d=s(3185);const u=["assets/image/planet.png","assets/image/moon.png","assets/image/clock.png","assets/image/pattern.png"];var c=(0,r.Z)(l.Z).extend({name:"PolarPictureTool",components:{ThreeRenderer:o["default"]},data(){return{dragging:!1,download_image_name:"rendered_frame",mouse_mode:-1,prev_pointer_position:{x:0,y:0},mode:1,grid:!0,texture_offset:new n.FM8(0,0),texture_scale:new n.FM8(1,1),tiling:2}},computed:{tiling_label(){switch(this.tiling){case 0:return"tiling [disabled]";case 1:return"tiling [repeated]";case 2:return"tiling [mirrored]"}}},props:{image:{type:String,default:""}},mounted(){this.init(),document.addEventListener("keydown",this.handle_keydown)},beforeDestroy(){document.removeEventListener("keydown",this.handle_keydown)},methods:{async init(){let e=new n._12(1,1,1,1),t=await(0,_.NO)(d.DJ.polar_picture_tool);t.uniforms.u_mode.value=this.mode,t.uniforms.u_offset.value=this.texture_offset,t.uniforms.u_scale.value=this.texture_scale;let s=this.plane=new n.Kj0(e,t);this.$refs.three_renderer.scene.add(s);let i=this.image;"random"===i&&(i=u[Math.floor(Math.random()*u.length)]),this.load_texture(i)},set_mode(e){this.mode=e,this.$refs.three_renderer.scene.children.forEach((e=>{e.material instanceof n.jyz&&(e.material.uniforms.u_mode.value=this.mode)}))},open_file(){this.$refs.fileInput.click()},load_texture(e,t){return this.download_image_name=this.remove_extension(e),new Promise(((t,s)=>{let i=new n.dpR;i.load(e,(e=>{this.set_texture(e),t(e)}))}))},load_image(e){return new Promise(((t,s)=>{let i=new Image;i.src=e,i.onload=()=>{t(i)}}))},get_image_src(e){return new Promise(((t,s)=>{const i=new FileReader;i.onload=()=>{t(i.result)},i.readAsDataURL(e)}))},set_texture(e){this.reset_transformations(),this.texture=e,this.set_tiling(this.tiling),e.needsUpdate=!0,this.plane.material.uniforms.u_map.value=e},set_tiling(e){if(e%=3,this.tiling=e,this.texture){switch(e){case 0:this.texture.wrapS=n.uWy,this.texture.wrapT=n.uWy;break;case 1:this.texture.wrapS=n.rpg,this.texture.wrapT=n.rpg;break;case 2:this.texture.wrapS=n.OoA,this.texture.wrapT=n.OoA;break}this.texture.needsUpdate=!0}},async handle_image_upload(e){const t=e.target.files[0];if(t){const e=await this.get_image_src(t);let s=await this.load_image(e);this.download_image_name=this.remove_extension(t.name),this.set_texture(new n.xEZ(s))}},handle_mousedown(e){e.preventDefault(),this.prev_pointer_position.x=e.clientX,this.prev_pointer_position.y=e.clientY,this.mouse_mode=e.button,1===this.mouse_mode&&this.reset_transformations()},reset_transformations(){this.texture_offset.set(0,0),this.texture_scale.set(1,1)},handle_mouseup(e){this.mouse_mode=-1},handle_mousemove(e){if(this.mouse_mode>-1){let t=e.clientX-this.prev_pointer_position.x,s=e.clientY-this.prev_pointer_position.y;this.prev_pointer_position.x=e.clientX,this.prev_pointer_position.y=e.clientY;let i=t/this.$refs.three_renderer.width/4,a=s/this.$refs.three_renderer.height/4;switch(this.mouse_mode){case 0:this.texture_offset.x+=i,this.texture_offset.y-=a;break;case 2:this.texture_scale.x+=i,this.texture_scale.y-=a;break;default:break}}},handle_keydown(e){27!==e.keyCode&&32!==e.keyCode||this.reset_transformations()},async handle_drop(e){e.preventDefault(),this.dragging=!1;const t=e.dataTransfer.files;if(t.length>0){const e=t[0],s=await this.get_image_src(e);let i=await this.load_image(s);this.download_image_name=this.remove_extension(e.name),this.set_texture(new n.xEZ(i))}},handle_dragenter(e){this.dragging=!0,e.preventDefault()},handle_dragover(e){e.preventDefault()},round_to(e,t){if(isNaN(e)||isNaN(t))return NaN;const s=Math.pow(10,t);return Math.round(e*s)/s},remove_extension(e){if("string"!==typeof e)throw new Error("Input must be a string");const t=e.lastIndexOf(".");return-1===t?e:e.slice(0,t)}}}),m=c,h=s(1001),p=(0,h.Z)(m,i,a,!1,null,null,null),g=p.exports}}]);
//# sourceMappingURL=813.js.map