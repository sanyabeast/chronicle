"use strict";(self["webpackChunkchronicle"]=self["webpackChunkchronicle"]||[]).push([[159],{6680:function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});var i=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"a-star-pathfinder",on:{mousemove:e.handle_mousemove,mousedown:e.handle_mousedown,contextmenu:function(e){e.preventDefault()}}},[t("div",{staticClass:"control-panel"},[t("Tweakpane",{ref:"tweakpane"}),e._m(0)],1),t("Canvas2D",{ref:"canvas",attrs:{show_debug:!e.is_mobile,allow_user_scale:!0,allow_user_translate:!0,allow_context_menu:!0},on:{update:e.render}},[t("viewport",{attrs:{width:"10",height:"10"}},[t("rect",{attrs:{x:"1",y:"1",width:"2",height:"2"}})])],1)],1)},l=[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("ul",{staticClass:"info"},[t("li",[t("i",[e._v("Left")]),e._v(" mouse button - set "),t("b",{attrs:{color:"#"}},[e._v("start")])]),t("li",[t("i",[e._v("Right")]),e._v(" mouse button - set finish")])])}],h=s(7327),a=s(8318),n=s(77),o=s(7581),r=s(4026),c=s(4806);class d{constructor(e,t=0,s=0){(0,h.Z)(this,"minRange",void 0),(0,h.Z)(this,"maxRange",void 0),(0,h.Z)(this,"open",void 0),(0,h.Z)(this,"closed",void 0),(0,h.Z)(this,"neighbors",void 0),(0,h.Z)(this,"origin",void 0),(0,h.Z)(this,"destination",void 0),this.find_neighbors=e,this.minRange=t,this.maxRange=s,this.open=new Map,this.closed=new Map,this.neighbors=new Set}get reachable(){const e=new Map;return this.closed.forEach(((t,s)=>{e.set(s,t.path)})),e}static createNode(e=[],t=0){return{score:t,path:e}}findAllInRange(e){this.prepare(),this.origin=e,this.destination=void 0,this.open.set(e,d.createNode([e]));while(this.open.size>0){const e=this.closeClosestOpenNode();if(e&&e[1].score>=this.minRange&&(0===this.maxRange||e[1].score<=this.maxRange)&&this.allOptionCallback(e[0]),this.quitEarly(e[0]))break;this.maybeQueueNeighbors(e)}return this.minRange>0?Array.from(this.closed.keys()).filter((e=>this.closed.get(e).score>=this.minRange&&(0===this.maxRange||this.closed.get(e).score<=this.maxRange))):this.closed.keys()}find_path(e,t){this.prepare(),this.origin=e,this.destination=t,this.open.set(e,d.createNode([e]));let s=null;while(this.open.size>0){const e=this.closeLowestScoreOpenNode();if(e&&(e[0]===t||this.quitEarly(e[0]))){s=e;break}this.maybeQueueNeighbors(e)}return s&&s[1]?(s[1].path.forEach((e=>{this.pathCallback(e,s[1].path)})),s[1].path):(console.log(`No path between ${e} and ${t}`),null)}addNeighbor(e){this.neighbors.add(e)}find_neighbors(e,t){throw new Error("Not implemented")}prepare(){this.open.clear(),this.closed.clear()}get_distance(e,t,s){return s?s.length:0}quitEarly(e){return!1}is_valid_path(e){return!0}pathCallback(e,t){}allOptionCallback(e){}maybeQueueNeighbors(e){this.find_neighbors(e[0],this.neighbors),this.neighbors.forEach((t=>{const s=[...e[1].path,t];this.maybeQueueNeighbor(e[1],s,t)})),this.neighbors.clear()}maybeQueueNeighbor(e,t,s){if(!this.is_valid_path(s))return;let i=this.get_distance(this.origin,s,t);if(this.destination&&(i+=this.get_distance(s,this.destination,null)),!(0!==this.maxRange&&i>this.maxRange))if(this.open.has(s)||this.closed.has(s)){if(this.open.has(s)&&i<this.open.get(s).score){const e=this.open.get(s);return e.path=t,void(e.score=i)}if(this.closed.has(s)&&i<this.closed.get(s).score){const e=this.closed.get(s);return e.path=t,e.score=i,this.open.set(s,e),void this.closed.delete(s)}}else this.open.set(s,d.createNode(t,i))}closeLowestScoreOpenNode(){if(0===this.open.size)return null;let e=Array.from(this.open.entries()).reduce(((e,t)=>e[1].score<t[1].score?e:t));return this.open.delete(e[0]),this.closed.set(e[0],e[1]),e}closeClosestOpenNode(){if(0===this.open.size)return null;let e=Array.from(this.open.entries()).reduce(((e,t)=>e[1].path.length<t[1].path.length?e:t));return this.open.delete(e[0]),this.closed.set(e[0],e[1]),e}}var _=s(7471),p=s.n(_);const g={background:"#2E2E3A",free_cell:"#A3B1C6",blocked_cell:"#6A7485",start_cell:"#76B947",finish_cell:"#D85E47",cell_gap_color:"#404455",hovered_cell:"#31A2AC",path_color:"#FFAA22"};class u{is_same(e){return this.x==e.x&&this.y==e.y}constructor(e,t,s){(0,h.Z)(this,"x",void 0),(0,h.Z)(this,"y",void 0),(0,h.Z)(this,"blocked",void 0),this.x=e,this.y=t,this.blocked=s}}var f=(0,o.Z)(r.Z).extend({name:"AStarDemo",components:{Canvas2D:a.Z,Tweakpane:n.Z},mounted(){this.canvas=this.$refs.canvas,this.pathfinder=new d(this.find_neighbors.bind(this)),this.setup_tweakpane(),this.regenerate(),this.render()},beforeMount(){},methods:{find_neighbors(e,t){console.log(e,t);let s=e.x,i=e.y;s>0&&!this.cells[i][s-1].blocked&&t.add(this.cells[i][s-1]),s<this.grid_size-1&&!this.cells[i][s+1].blocked&&t.add(this.cells[i][s+1]),i>0&&!this.cells[i-1][s].blocked&&t.add(this.cells[i-1][s]),i<this.grid_size-1&&!this.cells[i+1][s].blocked&&t.add(this.cells[i+1][s]),this.allow_diagonal&&(s>0&&i>0&&!this.cells[i-1][s-1].blocked&&t.add(this.cells[i-1][s-1]),s<this.grid_size-1&&i>0&&!this.cells[i-1][s+1].blocked&&t.add(this.cells[i-1][s+1]),s>0&&i<this.grid_size-1&&!this.cells[i+1][s-1].blocked&&t.add(this.cells[i+1][s-1]),s<this.grid_size-1&&i<this.grid_size-1&&!this.cells[i+1][s+1].blocked&&t.add(this.cells[i+1][s+1]))},render(){this.canvas&&(this.canvas.clear(g.background),this.render_scene(),this.canvas.render())},render_scene(){for(let e=0;e<this.grid_size;e++)for(let t=0;t<this.grid_size;t++){let s=g.free_cell;this.cells[e][t].blocked&&(s=g.blocked_cell),this.canvas.draw_rect({x:t,y:e,width:1,height:1,fill_color:s,stroke_color:g.cell_gap_color}),this.start_cell&&this.start_cell.x==t&&this.start_cell.y==e&&this.canvas.draw_rect({x:t+.1,y:e+.1,width:.8,height:.8,fill_color:g.start_cell,alpha:.5}),this.finish_cell&&this.finish_cell.x==t&&this.finish_cell.y==e&&this.canvas.draw_rect({x:t+.1,y:e+.1,width:.8,height:.8,fill_color:g.finish_cell}),!this.cells[e][t].blocked&&this.hovered_cell&&this.hovered_cell.x==t&&this.hovered_cell.y==e&&this.canvas.draw_rect({x:t,y:e,width:1,height:1,fill_color:g.hovered_cell,alpha:.3})}this.path&&this.canvas.draw_line({points:(0,c.map)(this.path,(e=>({x:e.x+.5,y:e.y+.5}))),stroke_color:g.path_color,line_width:.03,alpha:1})},update_canvas(){this.canvas.viewport.width=this.grid_size,this.canvas.viewport.height=this.grid_size,this.canvas.user.scale=1,this.canvas.resize_canvas()},fill_random_cells(){for(let e=0;e<this.grid_size;e++){this.cells[e]=[];for(let t=0;t<this.grid_size;t++)this.seeded_random()<this.blockiness?this.cells[e][t]=new u(t,e,!0):this.cells[e][t]=new u(t,e,!1)}},regenerate(){this.reset(),this.update_random_generator(),this.fill_random_cells(),this.canvas.reset_user_transform(),this.update_canvas(),this.canvas.centrize()},update_random_generator(){this.seeded_random=p()(this.seed.toString())},update_path(){if(this.start_cell&&this.finish_cell){let e=this.pathfinder.find_path(this.start_cell,this.finish_cell);this.path=e,console.log(e)}},handle_mousemove(e){if(this.canvas){let t=this.canvas.screen_to_viewport({x:e.offsetX,y:e.offsetY}),s=Math.floor(t.x),i=Math.floor(t.y);this.hovered_cell.x=s,this.hovered_cell.y=i,this.render()}},handle_mousedown(e){let t=this.canvas.screen_to_viewport({x:e.offsetX,y:e.offsetY}),s=Math.floor(t.x),i=Math.floor(t.y);if(!(s<0||s>=this.grid_size||i<0||i>=this.grid_size)){if(!this.cells[i][s].blocked){switch(e.button){case 0:this.start_cell=this.cells[i][s];break;case 2:this.finish_cell=this.cells[i][s];break}this.update_path()}console.log(e)}},reset(){this.start_cell=null,this.finish_cell=null,this.path=null},setup_tweakpane(){let e=this.$refs.tweakpane.pane;e.addBlade({view:"separator"}),e.addBinding(this,"grid_size",{label:"Grid Size",min:2,max:20,step:1}).on("change",(0,c.throttle)((()=>{this.regenerate(),this.render()}),1e3/60)),e.addBinding(this,"blockiness",{label:"Blockiness",min:0,max:1,step:.01}).on("change",(0,c.throttle)((()=>{this.regenerate(),this.render()}),1e3/60)),e.addBinding(this,"allow_diagonal",{label:"Allow Diagonal"}).on("change",(0,c.throttle)((()=>{this.update_path(),this.render()}),1e3/60)),e.addBinding(this,"seed",{label:"Seed",min:0,max:1e4,step:1}).on("change",(0,c.throttle)((()=>{this.regenerate(),this.render()}),1e3/15)),e.addButton({title:"Reset Viewport"}).on("click",(()=>{this.canvas.reset_user_transform()}))}},computed:{},props:{category:String},data(){return{grid_size:10,blockiness:.25,cells:[],seed:404,allow_diagonal:!1,hovered_cell:{x:-1,y:-1},start_cell:{x:-1,y:-1},finish_cell:{x:-1,y:-1}}}}),v=f,b=s(1001),m=(0,b.Z)(v,i,l,!1,null,null,null),w=m.exports}}]);
//# sourceMappingURL=159.js.map